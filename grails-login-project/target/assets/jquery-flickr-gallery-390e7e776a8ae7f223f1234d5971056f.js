var flickrhelpers=null;(function(e){e.fn.flickrGallery=function(t){var n=e(this),r=this;var s={init:function(){u=e.extend({},o,t);if(u.flickrKey===null||u.flickrSet===null){alert("You must pass an API key and a Flickr setID");return}$("body").append('<div id="flickr_loader"></div>');$("#flickr_loader").css({width:r.width(),height:r.height(),"background-color":"#FFF"});r.css("overflow","hidden");$.getJSON("http://api.flickr.com/services/rest/?format=json&method=flickr.photosets.getPhotos&photoset_id="+u.flickrSet+"&api_key="+u.flickrKey+"&jsoncallback=?",function(e){var t=e.photoset.photo.length;var n="";for(i=0;i<t;i++){var s="http://farm"+e.photoset.photo[i].farm+"."+"static.flickr.com/"+e.photoset.photo[i].server+"/"+e.photoset.photo[i].id+"_"+e.photoset.photo[i].secret+".jpg";var o="http://farm"+e.photoset.photo[i].farm+"."+"static.flickr.com/"+e.photoset.photo[i].server+"/"+e.photoset.photo[i].id+"_"+e.photoset.photo[i].secret+"_s.jpg";n+="<img src="+o+' width="50" height="50" onclick="flickrhelpers.navImg('+i+');flickrhelpers.toggleUp();" style="cursor: pointer;">';u.imgArray[i]=s;u.titleArray[i]=e.photoset.photo[i].title}$("body").append('<div id="flickr_next"></div>');$("body").append('<div id="flickr_prev"></div>');$("#flickr_next").click(function(){if(u.currentIndex<u.imgArray.length-1){u.currentIndex=u.currentIndex+1;flickrhelpers.navImg(u.currentIndex)}});$("#flickr_prev").click(function(){if(u.currentIndex>0){u.currentIndex=u.currentIndex-1;flickrhelpers.navImg(u.currentIndex)}});u.x=r.offset().left;u.y=r.offset().top;u.c=u.x+r.width()/2;u.ct=u.y+r.height()/2;$("#flickr_loader").css({left:u.x,top:u.y});$("body").append('<div id="flickr_thumbs"></div>');$("#flickr_thumbs").css("background-color",r.css("background-color"));$("#flickr_thumbs").css("width",r.width());$("#flickr_thumbs").css("left",u.x);$("#flickr_thumbs").css("top",u.y);$("#flickr_thumbs").html(n);$("#flickr_thumbs").slideUp("slow");flickrhelpers.navImg(0)})}};flickrhelpers={navImg:function(e){currentIndex=e;$("#flickr_loader").css({top:u.y,left:u.x,display:"block"});var t=null;t=new Image;t.src=u.imgArray[e];u.fImg=$(t);r.html("");r.html('<img id="thsImage" src='+u.imgArray[e]+" border=0>");$("#thsImage").load(function(){var e=$("#thsImage").width();var t=$("#thsImage").height();if(e>t){var n=e/t;$("#thsImage").css("width",r.width());$("#thsImage").css("height",Math.round(r.width()*(1/n)))}else{var n=t/e;$("#thsImage").css("height",r.height());$("#thsImage").css("width",Math.round(r.height()*(1/n)))}if(r.outerHeight()>$("#thsImage").outerHeight()){var i=$("#thsImage").outerHeight()/2;var s=r.outerHeight()/2-i;$("#thsImage").css("margin-top",s+"px")}var o=currentIndex+1;$("#flickr_count").html("Photo "+o+" of "+u.imgArray.length);if(u.titleArray[currentIndex]!=""){$("#flickr_count").append(" : "+u.titleArray[currentIndex])}$("#flickr_loader").fadeOut()})},toggleUp:function(){$("#flickr_thumbs").slideUp("slow")}};var o={flickrSet:null,flickrKey:null,x:0,y:0,c:0,ct:0,mX:0,mY:0,imgArray:[],titleArray:[],currentIndex:0,fImg:null};var u={};e(document).ready(function(){s.init()});$(window).resize(function(){u.x=r.offset().left;u.y=r.offset().top;u.c=u.x+r.width()/2;u.ct=u.y+r.height()/2;$("#flickr_loader").css("background-color","#fff");$("#flickr_loader").css("width",r.width()+"px");$("#flickr_loader").css("height",r.height()+"px");$("#flickr_thumbs").css("background-color",r.css("background-color"));$("#flickr_thumbs").css("width",r.width()+"px");$("#flickr_thumbs").css("left",u.x+"px");$("#flickr_thumbs").css("top",u.y+"px")});$(document).mousemove(function(e){u.mX=e.pageX;u.mY=e.pageY;var t=u.y+r.height();var n=u.x+r.width();if(u.mY>u.y&&u.mY<t&&u.mX>u.x&&u.mX<n){if(u.mY<u.y+50){$("#flickr_thumbs").slideDown("slow")}else if(u.mY>u.y+$("#flickr_thumbs").outerHeight()){$("#flickr_thumbs").slideUp("slow")}if(u.mX<u.c){$("#flickr_next").css("display","none");$("#flickr_prev").css("display","block");$("#flickr_prev").css("left",u.mX-20+"px");$("#flickr_prev").css("top",u.mY-10+"px")}else if(u.mX>u.c){$("#flickr_prev").css("display","none");$("#flickr_next").css("display","block");$("#flickr_next").css("left",u.mX-10+"px");$("#flickr_next").css("top",u.mY-10+"px")}else{$("#flickr_prev").css("display","none");$("#flickr_next").css("display","none")}}else{$("#flickr_thumbs").slideUp("slow");$("#flickr_prev").css("display","none");$("#flickr_next").css("display","none")}})}})(jQuery)